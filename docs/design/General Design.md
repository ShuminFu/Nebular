#### Wrapping class of the frameworks and ENVs 
So we need to [[wrap]] up with `Framework` such as `aider`, `autogen`, `others like crewAI`, these frameworks have the same ability to `run`, `read`, `write`, maybe `execute(just like autogen's user_proxy)`. And they, so called `framework-agents`, can be instantiated as `xxx-xxfunc`
Moreover, these wrapped frameworks need to be available to call Opera's webapi as their native function calls.

Each `Framework` have its own method to call LLMs, such as integrated `LiteLLM`, and what we need to wrap is to convert the ENVs being compatible with different Framework.
#### Receiving SignalR and activate framework on callbacks #loop1
This need to be a keep-running program in the background. Can be extended from the `opera_signalr_client.py`.
Actions needed:
`OnStaffInvited`, duplicate a current bot or let it be queued until available?
`OnMessageReceived`, need a Commander to decide what to do next with the mentioned Bot I guess.

#### Main loop #loop2
The workflow can be like this. We have two loops in the begining, one is the signalr client which keep connection with opera with listening its method, and the othere is the BotManager.
BotManager will first initiate some basic bots by creating thread/processing (need to invest). The list can be:
`Memory_retriever`, who is responsible to collect infos from  `history_experience-db`, `opera-resources&dialogue`(summary, determine wether neccessary and convey the needed info to operas in different depth), ``
`Code_monkey`, who is responsible to colletct `repo_maps`, create files, delete files, modify codes based on diff/whole modes and the generated codes given by other Bots. Maybe monkeys can also play with git-controls?
`Commander`, giving prompts and initaite Bots' actions. Having the ability to create Bots with specific configs (Also can create Threads and Processing, all the abilities are registered functions); 
`Coding_group`, by default is a `groupchat` of multiple framework-agents with pre-defined roles (generated by Commander with given character-profiles): `Coder`, `Executer`, `advisor` and `groupchat-manager`.

[[概要设计 - Bot Manager System]]